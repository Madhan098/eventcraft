{% extends "base.html" %}

{% block title %}Theme Gallery - EventCraft Pro{% endblock %}

{% block extra_head %}
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
/* ðŸŽ¨ Theme Gallery - Clean Design with Image-First Layout */
:root {
    --reddish-brown: #6F4E37;
    --reddish-brown-dark: #5D4037;
    --golden-yellow: #D4AF37;
    --golden-yellow-bright: #FFD700;
    
    --bg-cream: #FFFFFF;
    --bg-white: #FFFFFF;
    --bg-card: #FAFAFA;
    
    --text-dark: #1a1a1a;
    --text-gray: #666666;
    --text-light-gray: #999999;
    
    --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.06);
    --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.08);
    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
    
    --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: var(--bg-cream);
    color: var(--text-dark);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* Theme Gallery Header */
.theme-gallery-header {
    padding: 80px 40px 60px;
    text-align: center;
    background: var(--bg-cream);
}

.header-content {
    max-width: 1200px;
    margin: 0 auto;
}

.theme-gallery-title {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 16px;
    font-size: 56px;
    font-weight: 700;
    line-height: 1.1;
    letter-spacing: -0.02em;
    margin-bottom: 24px;
}

.title-icon {
    font-size: 48px;
    color: #D4AF37;
    text-shadow: 2px 2px 4px rgba(212, 175, 55, 0.3);
}

.title-text {
    display: flex;
    gap: 8px;
}

.title-theme {
    color: #6F4E37;
    font-weight: 800;
    text-shadow: 2px 2px 4px rgba(111, 78, 55, 0.2);
}

.title-gallery {
    color: #D4AF37;
    font-weight: 800;
    text-shadow: 2px 2px 4px rgba(212, 175, 55, 0.3);
}

.theme-gallery-subtitle {
    font-size: 18px;
    color: #5D4037;
    line-height: 1.6;
    max-width: 700px;
    margin: 0 auto;
    font-weight: 500;
}

/* Filter Buttons */
.filters-section {
    padding: 0 40px 60px;
    background: var(--bg-cream);
}

.filters-container {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    justify-content: center;
    gap: 12px;
    flex-wrap: wrap;
}

.filter-btn {
    padding: 12px 24px;
    border-radius: 24px;
    border: 2px solid var(--reddish-brown);
    background: var(--bg-white);
    color: var(--text-dark);
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: all var(--transition);
    font-family: inherit;
    white-space: nowrap;
}

.filter-btn:hover {
    background: var(--reddish-brown);
    color: #FFFFFF;
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.filter-btn.active {
    background: linear-gradient(135deg, #6F4E37 0%, #D4AF37 100%);
    border-color: transparent;
    color: #FFFFFF;
    box-shadow: var(--shadow-sm);
}

.filter-btn.active:hover {
    background: linear-gradient(135deg, #5D4037 0%, #C9A961 100%);
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

/* Theme Cards Grid */
.themes-section {
    padding: 0 40px 100px;
    background: var(--bg-cream);
}

.themes-grid {
    max-width: 1400px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 32px;
    min-height: 400px;
}

/* Theme Card - Image First Design */
.theme-card {
    background: var(--bg-white);
    border: 1px solid #e5e7eb;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: var(--shadow-sm);
    transition: all var(--transition);
    cursor: pointer;
    display: flex;
    flex-direction: column;
}

.theme-card:hover {
    transform: translateY(-8px);
    box-shadow: var(--shadow-lg);
    border-color: var(--golden-yellow);
}

/* Card Image - Takes up top 60% */
.card-image-wrapper {
    width: 100%;
    height: 280px;
    overflow: hidden;
    background: var(--bg-card);
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

.theme-preview-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition);
    display: block;
}

.theme-card:hover .theme-preview-image {
    transform: scale(1.08);
}

/* Image Loading State */
.card-image-wrapper.loading {
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s infinite;
}

@keyframes skeleton-loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

/* Image Placeholder */
.image-placeholder {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    color: var(--text-gray);
}

.image-placeholder i {
    font-size: 48px;
    margin-bottom: 12px;
    opacity: 0.3;
}

.image-placeholder p {
    font-size: 14px;
    opacity: 0.6;
}

/* Card Content - Below Image */
.card-content {
    padding: 24px;
    display: flex;
    flex-direction: column;
    gap: 16px;
    flex: 1;
}

/* Template Name - Bold & Prominent with Solid Coffee Color */
.card-title {
    font-size: 22px;
    font-weight: 700;
    margin: 0;
    line-height: 1.3;
    color: #6F4E37;
    transition: color 0.3s ease;
}

.theme-card:hover .card-title {
    color: #D4AF37;
}

/* Event Type Badge */
.event-type-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 14px;
    background: linear-gradient(135deg, #6F4E37 0%, #D4AF37 100%);
    color: #FFFFFF;
    border-radius: 20px;
    font-size: 13px;
    font-weight: 600;
    text-transform: capitalize;
    width: fit-content;
}

/* Description */
.card-description {
    font-size: 15px;
    color: #5D4037;
    line-height: 1.6;
    margin: 0;
    flex: 1;
    font-weight: 500;
}

/* Use Template Button */
.use-theme-btn {
    width: 100%;
    padding: 14px 24px;
    background: var(--text-dark);
    color: #FFFFFF;
    border: none;
    border-radius: 10px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-family: inherit;
    text-decoration: none;
    margin-top: auto;
}

.use-theme-btn:hover {
    background: linear-gradient(135deg, #6F4E37 0%, #D4AF37 100%);
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.use-theme-btn i {
    transition: transform var(--transition);
}

.use-theme-btn:hover i {
    transform: translateX(4px);
}

/* Template Count */
.template-count {
    position: absolute;
    bottom: 12px;
    right: 12px;
    background: rgba(0, 0, 0, 0.7);
    color: #FFFFFF;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    z-index: 2;
}

/* Empty State */
.empty-state {
    grid-column: 1 / -1;
    text-align: center;
    padding: 80px 40px;
}

.empty-state i {
    font-size: 64px;
    color: var(--text-light-gray);
    margin-bottom: 24px;
    opacity: 0.5;
}

.empty-state h3 {
    font-size: 24px;
    color: var(--text-dark);
    margin-bottom: 12px;
}

.empty-state p {
    font-size: 16px;
    color: var(--text-gray);
    max-width: 500px;
    margin: 0 auto;
}

/* Responsive */
@media (max-width: 1200px) {
    .themes-grid {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 24px;
    }
}

@media (max-width: 768px) {
    .theme-gallery-header {
        padding: 60px 24px 40px;
    }
    
    .theme-gallery-title {
        font-size: 36px;
        flex-direction: column;
        gap: 12px;
    }
    
    .title-icon {
        font-size: 36px;
    }
    
    .theme-gallery-subtitle {
        font-size: 16px;
    }
    
    .filters-section {
        padding: 0 24px 40px;
    }
    
    .filters-container {
        gap: 8px;
    }
    
    .filter-btn {
        padding: 10px 20px;
        font-size: 14px;
    }
    
    .themes-section {
        padding: 0 24px 60px;
    }
    
    .themes-grid {
        grid-template-columns: 1fr;
        gap: 20px;
    }
    
    .card-image-wrapper {
        height: 220px;
    }
    
    .card-content {
        padding: 20px;
    }
}

@media (max-width: 480px) {
    .theme-gallery-title {
        font-size: 28px;
    }
    
    .title-icon {
        font-size: 28px;
    }
    
    .filter-btn {
        padding: 8px 16px;
        font-size: 13px;
    }
    
    .card-title {
        font-size: 20px;
    }
    
    .card-description {
        font-size: 14px;
    }
}
</style>
{% endblock %}

{% block content %}
<!-- Theme Gallery Header -->
<section class="theme-gallery-header">
    <div class="header-content">
        <h1 class="theme-gallery-title">
            <span class="title-icon">âœ¶</span>
            <span class="title-text">
                <span class="title-theme">Theme </span>
                <span class="title-gallery">Gallery</span>
            </span>
        </h1>
        <p class="theme-gallery-subtitle">Explore our curated collection of invitation designs. Each theme tells a unique story â€” find yours.</p>
    </div>
</section>

<!-- Filter Buttons -->
<section class="filters-section">
    <div class="filters-container">
        <button class="filter-btn active" data-filter="all">All Occasions</button>
        <button class="filter-btn" data-filter="wedding">Wedding</button>
        <button class="filter-btn" data-filter="birthday">Birthday</button>
        <button class="filter-btn" data-filter="engagement">Engagement</button>
        <button class="filter-btn" data-filter="anniversary">Anniversary</button>
        <button class="filter-btn" data-filter="babyshower">Baby Shower</button>
        <button class="filter-btn" data-filter="graduation">Graduation</button>
        <button class="filter-btn" data-filter="retirement">Retirement</button>
        <button class="filter-btn" data-filter="corporate">Corporate</button>
    </div>
</section>

<!-- Theme Cards Grid -->
<section class="themes-section">
    <div class="themes-grid" id="themesGrid">
        {% if templates and templates|length > 0 %}
            {% for template in templates %}
                {% set template_img = template.preview_image %}
                
                {# Ensure correct image path #}
                {% if template_img %}
                    {# Remove /static/ prefix if present #}
                    {% if template_img.startswith('/static/') %}
                        {% set template_img = template_img.replace('/static/', '/') %}
                    {% endif %}
                    
                    {# Ensure it starts with /images/ #}
                    {% if not template_img.startswith('/images/') and not template_img.startswith('http') %}
                        {% if template_img.startswith('/') %}
                            {% set template_img = '/images' + template_img %}
                        {% else %}
                            {% set template_img = '/images/' + template_img %}
                        {% endif %}
                    {% endif %}
                {% else %}
                    {% set template_img = '/images/templatesimages/default.png' %}
                {% endif %}
                
                <div class="theme-card" 
                     data-event-type="{{ template.event_type|lower }}" 
                     data-template-id="{{ template.id }}">
                    
                    <!-- Image First -->
                    <div class="card-image-wrapper loading">
                        <img src="{{ template_img }}" 
                             alt="{{ template.name }}" 
                             class="theme-preview-image"
                             loading="lazy"
                             onerror="this.onerror=null; this.closest('.card-image-wrapper').innerHTML='<div class=\'image-placeholder\'><i class=\'fas fa-image\'></i><p>{{ template.name }}</p></div>';"
                             onload="this.closest('.card-image-wrapper').classList.remove('loading');">
                    </div>
                    
                    <!-- Content Below Image -->
                    <div class="card-content">
                        <!-- Template Name -->
                        <h3 class="card-title">{{ template.name }}</h3>
                        
                        <!-- Event Type Badge -->
                        <div class="event-type-badge">
                            <i class="fas fa-tag"></i>
                            {{ template.event_type }}
                        </div>
                        
                        <!-- Description -->
                        {% if template.description %}
                        <p class="card-description">{{ template.description }}</p>
                        {% else %}
                        <p class="card-description">Beautiful {{ template.event_type }} invitation template perfect for your special occasion.</p>
                        {% endif %}
                        
                        <!-- Use Template Button -->
                        <a href="/create-invitation?template_id={{ template.id }}&event_type={{ template.event_type }}" 
                           class="use-theme-btn">
                            Choose This Template
                            <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <!-- Empty State -->
            <div class="empty-state">
                <i class="fas fa-palette"></i>
                <h3>No Templates Available</h3>
                <p>We're working on adding beautiful templates for you. Please check back soon!</p>
            </div>
        {% endif %}
    </div>
</section>
{% endblock %}

{% block extra_scripts %}
<script>
// Filter functionality
document.addEventListener('DOMContentLoaded', function() {
    const filterButtons = document.querySelectorAll('.filter-btn');
    const themeCards = document.querySelectorAll('.theme-card');
    
    // Filter functionality
    filterButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Remove active class from all buttons
            filterButtons.forEach(btn => btn.classList.remove('active'));
            // Add active class to clicked button
            this.classList.add('active');
            
            const filter = this.dataset.filter;
            
            // Filter cards with animation
            themeCards.forEach((card, index) => {
                const eventType = card.dataset.eventType || '';
                const matches = filter === 'all' || eventType === filter;
                
                if (matches) {
                    card.style.display = 'flex';
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';
                    
                    setTimeout(() => {
                        card.style.transition = 'all 0.4s ease';
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, index * 30);
                } else {
                    card.style.transition = 'all 0.3s ease';
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(-20px)';
                    
                    setTimeout(() => {
                        card.style.display = 'none';
                    }, 300);
                }
            });
        });
    });
    
    // Initial animation
    themeCards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            card.style.transition = 'all 0.4s ease';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 50);
    });
    
    // Optimize image loading
    const imageObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const img = entry.target;
                img.classList.add('loading');
                imageObserver.unobserve(img);
            }
        });
    }, {
        rootMargin: '50px'
    });
    
    // Observe all images
    document.querySelectorAll('.theme-preview-image').forEach(img => {
        if (img.complete) {
            img.closest('.card-image-wrapper')?.classList.remove('loading');
        } else {
            imageObserver.observe(img);
        }
    });
    
    // Log for debugging
    console.log('Total templates loaded:', themeCards.length);
});
</script>
{% endblock %}
