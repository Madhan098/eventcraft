{% extends "base.html" %}

{% block title %}Pick a Template - EventCraft Pro{% endblock %}

{% block content %}
<!-- Templates Hero Section -->
<section class="templates-hero py-5 bg-light">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h1 class="hero-title display-4 fw-bold mb-3">All Available Templates</h1>
                <p class="hero-subtitle lead text-muted">Browse and filter through our complete collection of invitation templates.</p>
            </div>
            <div class="col-lg-6">
                <div class="lottie-container">
                    <!-- Lottie Animation will be placed here -->
                    <div class="lottie-placeholder">
                        <div class="lottie-icon">
                            <i class="fas fa-magic fa-6x text-primary"></i>
                        </div>
                        <p class="text-muted mt-3">Lottie Animation Space</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Templates Section with Filters -->
<section class="templates-section py-5">
    <div class="container">
        <div class="row">
            <!-- Filters Sidebar -->
            <div class="col-lg-3">
                <div class="filters-sidebar">
                    <div class="filters-header d-flex justify-content-between align-items-center mb-4">
                        <h5 class="fw-bold mb-0">Filters</h5>
                        <a href="#" class="text-decoration-none text-primary clear-filters">Clear Filters</a>
                    </div>
                    
                    <!-- Event Type Filter -->
                    <div class="filter-group mb-4">
                        <h6 class="filter-title fw-bold mb-3">Event Type</h6>
                        <div class="filter-options">
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="wedding" id="filter-wedding">
                                <label class="form-check-label" for="filter-wedding">
                                    Wedding
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="birthday" id="filter-birthday">
                                <label class="form-check-label" for="filter-birthday">
                                    Birthday Party
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="anniversary" id="filter-anniversary">
                                <label class="form-check-label" for="filter-anniversary">
                                    Anniversary
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="babyshower" id="filter-babyshower">
                                <label class="form-check-label" for="filter-babyshower">
                                    Baby Shower
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="graduation" id="filter-graduation">
                                <label class="form-check-label" for="filter-graduation">
                                    Graduation Party
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="retirement" id="filter-retirement">
                                <label class="form-check-label" for="filter-retirement">
                                    Retirement Party
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Style Filter -->
                    <div class="filter-group mb-4">
                        <h6 class="filter-title fw-bold mb-3">Style</h6>
                        <div class="filter-options">
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="traditional" id="filter-traditional">
                                <label class="form-check-label" for="filter-traditional">
                                    Traditional
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="modern" id="filter-modern">
                                <label class="form-check-label" for="filter-modern">
                                    Modern
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="elegant" id="filter-elegant">
                                <label class="form-check-label" for="filter-elegant">
                                    Elegant
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="fun" id="filter-fun">
                                <label class="form-check-label" for="filter-fun">
                                    Fun & Colorful
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="classic" id="filter-classic">
                                <label class="form-check-label" for="filter-classic">
                                    Classic
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Theme Filter -->
                    <div class="filter-group mb-4">
                        <h6 class="filter-title fw-bold mb-3">Theme</h6>
                        <div class="filter-options">
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="hindu" id="filter-hindu">
                                <label class="form-check-label" for="filter-hindu">
                                    Hindu
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="muslim" id="filter-muslim">
                                <label class="form-check-label" for="filter-muslim">
                                    Muslim
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="christian" id="filter-christian">
                                <label class="form-check-label" for="filter-christian">
                                    Christian
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input filter-check-input" type="checkbox" value="secular" id="filter-secular">
                                <label class="form-check-label" for="filter-secular">
                                    Secular
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Templates Grid -->
            <div class="col-lg-9">
                <!-- Search and Sort Bar -->
                <div class="templates-controls mb-4">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <div class="search-box">
                                <div class="input-group">
                                    <span class="input-group-text bg-white border-end-0">
                                        <i class="fas fa-search text-muted"></i>
                                    </span>
                                    <input type="text" class="form-control border-start-0" id="template-search" placeholder="Search templates...">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex justify-content-end gap-3">
                                <div class="sort-dropdown">
                                    <select class="form-select" id="sort-templates">
                                        <option value="popular">Most Popular</option>
                                        <option value="newest">Newest First</option>
                                        <option value="alphabetical">A-Z</option>
                                        <option value="event-type">Event Type</option>
                                    </select>
                                </div>
                                <div class="view-toggle">
                                    <button class="btn btn-outline-secondary active" id="grid-view" title="Grid View">
                                        <i class="fas fa-th"></i>
                                    </button>
                                    <button class="btn btn-outline-secondary" id="list-view" title="List View">
                                        <i class="fas fa-list"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Results Counter -->
                <div class="results-info mb-3">
                    <span class="text-muted">Showing <span id="results-count">8</span> templates</span>
                </div>
                
                <div class="templates-grid">
                    <div class="row g-4" id="templates-container">
                        <!-- Wedding Templates -->
                        <div class="col-lg-4 col-md-6 template-item" data-event-type="wedding" data-style="elegant" data-theme="secular">
                            <div class="template-card">
                                <div class="template-preview wedding-elegant-preview">
                                    <div class="template-overlay">
                                        <div class="template-icon">
                                            <i class="fas fa-heart"></i>
                                        </div>
                                        <div class="template-content">
                                            <h4 class="template-title">Wedding Elegant</h4>
                                            <p class="template-description">Perfect for your special day</p>
                                            <div class="template-tags">
                                                <span class="tag">Wedding</span>
                                                <span class="tag">Elegant</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="template-actions text-center mt-3">
                                    <a href="{{ url_for('create_invitation') }}?template=wedding_elegant" class="btn btn-primary-custom w-100">
                                        Choose Template
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 col-md-6 template-item" data-event-type="wedding" data-style="traditional" data-theme="hindu">
                            <div class="template-card">
                                <div class="template-preview wedding-hindu-preview">
                                    <div class="template-overlay">
                                        <div class="template-icon">
                                            <i class="fas fa-om"></i>
                                        </div>
                                        <div class="template-content">
                                            <h4 class="template-title">Wedding Hindu Traditional</h4>
                                            <p class="template-description">Sacred Hindu ceremony design</p>
                                            <div class="template-tags">
                                                <span class="tag">Wedding</span>
                                                <span class="tag">Hindu</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="template-actions text-center mt-3">
                                    <a href="{{ url_for('create_invitation') }}?template=wedding_hindu_traditional" class="btn btn-primary-custom w-100">
                                        Choose Template
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 col-md-6 template-item" data-event-type="wedding" data-style="elegant" data-theme="muslim">
                            <div class="template-card">
                                <div class="template-preview wedding-muslim-preview">
                                    <div class="template-overlay">
                                        <div class="template-icon">
                                            <i class="fas fa-moon"></i>
                                        </div>
                                        <div class="template-content">
                                            <h4 class="template-title">Wedding Muslim Elegant</h4>
                                            <p class="template-description">Beautiful Islamic wedding design</p>
                                            <div class="template-tags">
                                                <span class="tag">Wedding</span>
                                                <span class="tag">Muslim</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="template-actions text-center mt-3">
                                    <a href="{{ url_for('create_invitation') }}?template=wedding_muslim_elegant" class="btn btn-primary-custom w-100">
                                        Choose Template
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Birthday Templates -->
                        <div class="col-lg-4 col-md-6 template-item" data-event-type="birthday" data-style="fun" data-theme="secular">
                            <div class="template-card">
                                <div class="template-preview birthday-fun-preview">
                                    <div class="template-overlay">
                                        <div class="template-icon">
                                            <i class="fas fa-birthday-cake"></i>
                                        </div>
                                        <div class="template-content">
                                            <h4 class="template-title">Birthday Fun Colorful</h4>
                                            <p class="template-description">Celebrate in style</p>
                                            <div class="template-tags">
                                                <span class="tag">Birthday</span>
                                                <span class="tag">Fun</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="template-actions text-center mt-3">
                                    <a href="{{ url_for('create_invitation') }}?template=birthday_fun_colorful" class="btn btn-primary-custom w-100">
                                        Choose Template
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Anniversary Templates -->
                        <div class="col-lg-4 col-md-6 template-item" data-event-type="anniversary" data-style="elegant" data-theme="secular">
                            <div class="template-card">
                                <div class="template-preview anniversary-golden-preview">
                                    <div class="template-overlay">
                                        <div class="template-icon">
                                            <i class="fas fa-heart"></i>
                                        </div>
                                        <div class="template-content">
                                            <h4 class="template-title">Anniversary Golden Elegant</h4>
                                            <p class="template-description">Celebrate love & memories</p>
                                            <div class="template-tags">
                                                <span class="tag">Anniversary</span>
                                                <span class="tag">Golden</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="template-actions text-center mt-3">
                                    <a href="{{ url_for('create_invitation') }}?template=anniversary_golden_elegant" class="btn btn-primary-custom w-100">
                                        Choose Template
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Baby Shower Templates -->
                        <div class="col-lg-4 col-md-6 template-item" data-event-type="babyshower" data-style="fun" data-theme="secular">
                            <div class="template-card">
                                <div class="template-preview babyshower-sweet-preview">
                                    <div class="template-overlay">
                                        <div class="template-icon">
                                            <i class="fas fa-baby"></i>
                                        </div>
                                        <div class="template-content">
                                            <h4 class="template-title">Baby Shower Sweet Pink</h4>
                                            <p class="template-description">Welcome the little one</p>
                                            <div class="template-tags">
                                                <span class="tag">Baby Shower</span>
                                                <span class="tag">Sweet</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="template-actions text-center mt-3">
                                    <a href="{{ url_for('create_invitation') }}?template=babyshower_sweet_pink" class="btn btn-primary-custom w-100">
                                        Choose Template
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Graduation Templates -->
                        <div class="col-lg-4 col-md-6 template-item" data-event-type="graduation" data-style="modern" data-theme="secular">
                            <div class="template-card">
                                <div class="template-preview graduation-modern-preview">
                                    <div class="template-overlay">
                                        <div class="template-icon">
                                            <i class="fas fa-graduation-cap"></i>
                                        </div>
                                        <div class="template-content">
                                            <h4 class="template-title">Graduation Success Modern</h4>
                                            <p class="template-description">Celebrate academic achievements</p>
                                            <div class="template-tags">
                                                <span class="tag">Graduation</span>
                                                <span class="tag">Modern</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="template-actions text-center mt-3">
                                    <a href="{{ url_for('create_invitation') }}?template=graduation_success_modern" class="btn btn-primary-custom w-100">
                                        Choose Template
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Retirement Templates -->
                        <div class="col-lg-4 col-md-6 template-item" data-event-type="retirement" data-style="classic" data-theme="secular">
                            <div class="template-card">
                                <div class="template-preview retirement-classic-preview">
                                    <div class="template-overlay">
                                        <div class="template-icon">
                                            <i class="fas fa-chair"></i>
                                        </div>
                                        <div class="template-content">
                                            <h4 class="template-title">Retirement Golden Classic</h4>
                                            <p class="template-description">Honor years of service</p>
                                            <div class="template-tags">
                                                <span class="tag">Retirement</span>
                                                <span class="tag">Classic</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="template-actions text-center mt-3">
                                    <a href="{{ url_for('create_invitation') }}?template=retirement_golden_classic" class="btn btn-primary-custom w-100">
                                        Choose Template
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Bottom Action Buttons -->
<section class="bottom-actions py-4 bg-light">
    <div class="container">
        <div class="d-flex justify-content-end gap-3">
            <a href="#" class="btn btn-secondary-custom">Choose Later</a>
            <a href="{{ url_for('create_invitation') }}" class="btn btn-primary-custom">Use this template</a>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_scripts %}
<script>
// Enhanced Filter and Search functionality
document.addEventListener('DOMContentLoaded', function() {
    const filterCheckboxes = document.querySelectorAll('.filter-check-input');
    const templateItems = document.querySelectorAll('.template-item');
    const clearFiltersLink = document.querySelector('.clear-filters');
    const searchInput = document.getElementById('template-search');
    const sortSelect = document.getElementById('sort-templates');
    const gridViewBtn = document.getElementById('grid-view');
    const listViewBtn = document.getElementById('list-view');
    const resultsCount = document.getElementById('results-count');
    const templatesContainer = document.getElementById('templates-container');
    
    let currentView = 'grid';
    
    // Function to apply filters and search
    function applyFilters() {
        const searchTerm = searchInput.value.toLowerCase();
        const selectedEventTypes = Array.from(document.querySelectorAll('input[value*="wedding"]:checked, input[value*="birthday"]:checked, input[value*="anniversary"]:checked, input[value*="babyshower"]:checked, input[value*="graduation"]:checked, input[value*="retirement"]:checked')).map(cb => cb.value);
        const selectedStyles = Array.from(document.querySelectorAll('input[value*="traditional"]:checked, input[value*="modern"]:checked, input[value*="elegant"]:checked, input[value*="fun"]:checked, input[value*="classic"]:checked')).map(cb => cb.value);
        const selectedThemes = Array.from(document.querySelectorAll('input[value*="hindu"]:checked, input[value*="muslim"]:checked, input[value*="christian"]:checked, input[value*="secular"]:checked')).map(cb => cb.value);
        
        let visibleCount = 0;
        
        templateItems.forEach(item => {
            const eventType = item.dataset.eventType;
            const style = item.dataset.style;
            const theme = item.dataset.theme;
            const title = item.querySelector('.template-title').textContent.toLowerCase();
            const description = item.querySelector('.template-description').textContent.toLowerCase();
            const tags = Array.from(item.querySelectorAll('.tag')).map(tag => tag.textContent.toLowerCase()).join(' ');
            
            const eventTypeMatch = selectedEventTypes.length === 0 || selectedEventTypes.includes(eventType);
            const styleMatch = selectedStyles.length === 0 || selectedStyles.includes(style);
            const themeMatch = selectedThemes.length === 0 || selectedThemes.includes(theme);
            const searchMatch = searchTerm === '' || title.includes(searchTerm) || description.includes(searchTerm) || tags.includes(searchTerm);
            
            if (eventTypeMatch && styleMatch && themeMatch && searchMatch) {
                item.style.display = 'block';
                visibleCount++;
            } else {
                item.style.display = 'none';
            }
        });
        
        // Update results count
        resultsCount.textContent = visibleCount;
        
        // Apply sorting
        applySorting();
    }
    
    // Function to apply sorting
    function applySorting() {
        const sortValue = sortSelect.value;
        const visibleItems = Array.from(templateItems).filter(item => item.style.display !== 'none');
        
        visibleItems.sort((a, b) => {
            const titleA = a.querySelector('.template-title').textContent;
            const titleB = b.querySelector('.template-title').textContent;
            
            switch(sortValue) {
                case 'alphabetical':
                    return titleA.localeCompare(titleB);
                case 'newest':
                    // For demo purposes, reverse alphabetical order
                    return titleB.localeCompare(titleA);
                case 'event-type':
                    const eventTypeA = a.dataset.eventType;
                    const eventTypeB = b.dataset.eventType;
                    return eventTypeA.localeCompare(eventTypeB);
                case 'popular':
                default:
                    // Keep original order for popular
                    return 0;
            }
        });
        
        // Reorder elements in DOM
        visibleItems.forEach(item => {
            templatesContainer.appendChild(item);
        });
    }
    
    // Add event listeners
    filterCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', applyFilters);
    });
    
    searchInput.addEventListener('input', applyFilters);
    sortSelect.addEventListener('change', applySorting);
    
    // Clear filters functionality
    clearFiltersLink.addEventListener('click', function(e) {
        e.preventDefault();
        filterCheckboxes.forEach(checkbox => {
            checkbox.checked = false;
        });
        searchInput.value = '';
        applyFilters();
    });
    
    // View toggle functionality
    gridViewBtn.addEventListener('click', function() {
        currentView = 'grid';
        gridViewBtn.classList.add('active');
        listViewBtn.classList.remove('active');
        templatesContainer.className = 'row g-4';
        templateItems.forEach(item => {
            item.className = 'col-lg-4 col-md-6 template-item';
        });
    });
    
    listViewBtn.addEventListener('click', function() {
        currentView = 'list';
        listViewBtn.classList.add('active');
        gridViewBtn.classList.remove('active');
        templatesContainer.className = 'row g-2';
        templateItems.forEach(item => {
            item.className = 'col-12 template-item';
        });
    });
    
    // Initialize filters - show all templates by default
    applyFilters();
});

// Intersection Observer for animations
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('animate-in');
        }
    });
}, observerOptions);

// Observe all template cards
document.querySelectorAll('.template-card').forEach(el => {
    observer.observe(el);
});
</script>
{% endblock %}

