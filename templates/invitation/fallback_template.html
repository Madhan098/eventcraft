{# Fallback Template - Used when no specific template matches #}
<div class="container my-5" style="position: relative; z-index: 2;">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="invitation-card p-5 shadow-lg" style="{% if template_image_url %}background-image: url('{{ template_image_url }}'); background-size: cover; background-position: center; background-repeat: no-repeat;{% else %}background: white;{% endif %} position: relative;">
                {% if template_image_url %}
                <!-- Template Background Overlay for better text readability -->
                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255, 255, 255, 0.85); border-radius: inherit; z-index: 1;"></div>
                <div style="position: relative; z-index: 2;">
                {% endif %}
                
                <!-- Main Image - DISPLAYED FIRST -->
                {% if invitation.main_image %}
                <div class="text-center mb-4">
                    <img src="{{ url_for('uploaded_file', filename=invitation.main_image) }}" 
                         alt="Event Image" 
                         class="img-fluid rounded shadow"
                         style="max-height: 400px; width: 100%; object-fit: cover;">
                </div>
                {% endif %}

                <!-- Event Icon -->
                <div class="text-center mb-4">
                    {% if invitation.event_type == 'wedding' %}
                        <div class="display-1">üíç</div>
                    {% elif invitation.event_type == 'birthday' %}
                        <div class="display-1">üéÇ</div>
                    {% elif invitation.event_type == 'anniversary' %}
                        <div class="display-1">üíë</div>
                    {% elif invitation.event_type == 'babyshower' %}
                        <div class="display-1">üë∂</div>
                    {% elif invitation.event_type == 'graduation' %}
                        <div class="display-1">üéì</div>
                    {% elif invitation.event_type == 'retirement' %}
                        <div class="display-1">üéâ</div>
                    {% else %}
                        <div class="display-1">‚ú®</div>
                    {% endif %}
                </div>

                <!-- Event Title -->
                <h1 class="text-center mb-4 text-overlay" style="font-size: 2.5rem; font-weight: 700;">
                    {{ invitation.title }}
                </h1>

                <!-- Event Date -->
                {% if invitation.event_date %}
                <div class="text-center mb-4">
                    <div class="text-overlay d-inline-block">
                        <i class="fas fa-calendar-alt me-2"></i>
                        <strong>Date:</strong> {{ invitation.event_date.strftime('%B %d, %Y') if invitation.event_date is not string else invitation.event_date }}
                    </div>
                </div>
                {% endif %}

                <!-- Event Time -->
                {% if invitation.event_time %}
                <div class="text-center mb-4">
                    <div class="text-overlay d-inline-block">
                        <i class="fas fa-clock me-2"></i>
                        <strong>Time:</strong> {{ invitation.event_time }}
                    </div>
                </div>
                {% endif %}

                <!-- Description -->
                {% if invitation.description %}
                <div class="text-center mb-4">
                    <div class="text-overlay" style="max-width: 600px; margin: 0 auto;">
                        <p class="lead mb-0">{{ invitation.description }}</p>
                    </div>
                </div>
                {% endif %}

                <!-- Venue Info -->
                {% if invitation.venue_address %}
                <div class="venue-info text-center mb-4">
                    <h4 style="color: #6F4E37; font-weight: 600; margin-bottom: 15px;">
                        <i class="fas fa-map-marker-alt me-2" style="color: #D4AF37;"></i>Venue
                    </h4>
                    <p class="mb-3" style="color: #5D4037; font-size: 16px;">{{ invitation.venue_address }}</p>
                    <button onclick="openLocation('{{ invitation.venue_address }}')" 
                            class="btn btn-location"
                            style="background: linear-gradient(135deg, #6F4E37 0%, #D4AF37 100%); 
                                   color: white; 
                                   border: none; 
                                   padding: 12px 30px; 
                                   border-radius: 25px; 
                                   font-weight: 600; 
                                   font-size: 16px;
                                   cursor: pointer;
                                   transition: all 0.3s ease;
                                   box-shadow: 0 4px 15px rgba(111, 78, 55, 0.3);
                                   display: inline-flex;
                                   align-items: center;
                                   gap: 8px;">
                        <i class="fas fa-map-marked-alt"></i>
                        Get Directions
                    </button>
                </div>
                {% endif %}

                <!-- Host Info -->
                {% if invitation.host_name %}
                <div class="text-center mb-4">
                    <div class="text-overlay d-inline-block">
                        <i class="fas fa-user me-2"></i>
                        <strong>Hosted by:</strong> {{ invitation.host_name }}
                    </div>
                </div>
                {% endif %}

                <!-- Contact Info -->
                {% if invitation.contact_email or invitation.contact_phone %}
                <div class="text-center mb-4">
                    <div class="text-overlay d-inline-block">
                        <i class="fas fa-envelope me-2"></i>
                        <strong>RSVP:</strong> 
                        {% if invitation.contact_email %}
                            {{ invitation.contact_email }}
                        {% endif %}
                        {% if invitation.contact_phone %}
                            {{ invitation.contact_phone }}
                        {% endif %}
                    </div>
                </div>
                {% endif %}

                <!-- Event-Specific Details -->
                {% if invitation.event_type == 'wedding' %}
                    {% if invitation.bride_name or invitation.groom_name or invitation.bride_image or invitation.groom_image %}
                    <div class="text-center mb-4">
                        <div class="text-overlay d-inline-block" style="width: 100%; max-width: 600px;">
                            <h3 class="mb-3">üíë</h3>
                            
                            <!-- Names First -->
                            {% if invitation.bride_name %}
                            <h4 class="mb-2" style="font-weight: 600; font-size: 1.5rem;">{{ invitation.bride_name }}</h4>
                            {% endif %}
                            {% if invitation.groom_name %}
                            <h4 class="mb-3" style="font-weight: 600; font-size: 1.5rem;">{{ invitation.groom_name }}</h4>
                            {% endif %}
                            
                            <!-- Photos Below Names -->
                            {% if invitation.bride_image or invitation.groom_image %}
                            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 15px;">
                                {% if invitation.bride_image %}
                                <div style="flex: 1; min-width: 150px; max-width: 200px;">
                                    <img src="{{ url_for('uploaded_file', filename=invitation.bride_image) }}" 
                                         alt="Bride" 
                                         class="img-fluid rounded shadow"
                                         style="width: 100%; height: 200px; object-fit: cover;">
                                </div>
                                {% endif %}
                                {% if invitation.groom_image %}
                                <div style="flex: 1; min-width: 150px; max-width: 200px;">
                                    <img src="{{ url_for('uploaded_file', filename=invitation.groom_image) }}" 
                                         alt="Groom" 
                                         class="img-fluid rounded shadow"
                                         style="width: 100%; height: 200px; object-fit: cover;">
                                </div>
                                {% endif %}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                {% elif invitation.event_type == 'birthday' %}
                    {% if invitation.birthday_person %}
                    <div class="text-center mb-4">
                        <div class="text-overlay d-inline-block">
                            <p class="mb-0"><strong>Birthday Person:</strong> {{ invitation.birthday_person }}</p>
                            {% if invitation.age %}
                            <p class="mb-0"><strong>Turning:</strong> {{ invitation.age }}</p>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                {% elif invitation.event_type == 'anniversary' %}
                    {% if invitation.couple_names %}
                    <div class="text-center mb-4">
                        <div class="text-overlay d-inline-block">
                            <p class="mb-0"><strong>Celebrating:</strong> {{ invitation.couple_names }}</p>
                            {% if invitation.marriage_years %}
                            <p class="mb-0"><strong>Years Together:</strong> {{ invitation.marriage_years }}</p>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                {% elif invitation.event_type == 'graduation' %}
                    {% if invitation.graduate_name %}
                    <div class="text-center mb-4">
                        <div class="text-overlay d-inline-block">
                            <p class="mb-0"><strong>Graduate:</strong> {{ invitation.graduate_name }}</p>
                            {% if invitation.degree %}
                            <p class="mb-0"><strong>Degree:</strong> {{ invitation.degree }}</p>
                            {% endif %}
                            {% if invitation.school %}
                            <p class="mb-0"><strong>School:</strong> {{ invitation.school }}</p>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                {% elif invitation.event_type == 'retirement' %}
                    {% if invitation.honoree_name %}
                    <div class="text-center mb-4">
                        <div class="text-overlay d-inline-block">
                            <p class="mb-0"><strong>Honoring:</strong> {{ invitation.honoree_name }}</p>
                            {% if invitation.position %}
                            <p class="mb-0"><strong>Position:</strong> {{ invitation.position }}</p>
                            {% endif %}
                            {% if invitation.company %}
                            <p class="mb-0"><strong>Company:</strong> {{ invitation.company }}</p>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                {% elif invitation.event_type == 'babyshower' %}
                    {% if invitation.mother_name or invitation.father_name %}
                    <div class="text-center mb-4">
                        <div class="text-overlay d-inline-block">
                            {% if invitation.mother_name %}
                            <p class="mb-2"><strong>Mother:</strong> {{ invitation.mother_name }}</p>
                            {% endif %}
                            {% if invitation.father_name %}
                            <p class="mb-0"><strong>Father:</strong> {{ invitation.father_name }}</p>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                {% endif %}

                <!-- Gallery Images - PROMINENT DISPLAY -->
                {% if invitation.gallery_images %}
                    {% set gallery = invitation.gallery_images|from_json if invitation.gallery_images is string else invitation.gallery_images %}
                    {% if gallery and gallery|length > 0 %}
                    <div class="text-center mb-5 mt-5">
                        <h3 class="mb-4" style="font-weight: 700; font-size: 1.8rem; color: #6F4E37;">üì∏ Photo Gallery</h3>
                        <div class="row g-3 mb-4">
                            {% for image in gallery[:12] %}
                            <div class="col-lg-4 col-md-6 col-6">
                                <img src="{{ url_for('uploaded_file', filename=image) }}" 
                                     alt="Gallery Image {{ loop.index }}" 
                                     class="img-fluid rounded shadow"
                                     style="width: 100%; height: 250px; object-fit: cover; cursor: pointer; border: 3px solid #D4AF37; transition: transform 0.3s;"
                                     onclick="this.style.transform = this.style.transform === 'scale(1.5)' ? 'scale(1)' : 'scale(1.5)'; this.style.zIndex = this.style.zIndex === '1000' ? '1' : '1000'; this.style.position = this.style.position === 'relative' ? 'static' : 'relative';">
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                {% endif %}
                {% if template_image_url %}
                </div><!-- Close z-index wrapper -->
                {% endif %}
            </div>
        </div>
    </div>
</div>

<style>
    .fallback-event-icon {
        font-size: 5rem;
        margin-bottom: 2rem;
    }
    
    .fallback-title {
        color: #2c3e50;
        font-weight: 700;
        margin-bottom: 2rem;
    }
    
    .fallback-detail {
        background: rgba(255, 255, 255, 0.95);
        padding: 1rem;
        border-radius: 10px;
        margin-bottom: 1rem;
        display: inline-block;
    }
</style>

